<nz-spin nzTip="loading..." [nzSpinning]="this.IS_LOADING">

  <form *ngIf="bindObj.checkStrictlyShow" checkStrictly nz-form nzLayout="inline">
    <nz-form-item>
      <nz-form-label><label>无关联勾选</label></nz-form-label>
      <nz-form-control>
        <nz-switch [(ngModel)]="bindObj.checkStrictly" name="checkStrictly"></nz-switch>
      </nz-form-control>
    </nz-form-item>
  </form>
  <nz-input-group *ngIf="bindObj.showSearch" [nzSuffix]="suffixIcon" style="width: 100%;">
    <input type="text" nz-input placeholder="查询" [(ngModel)]="bindObj.searchValue" />
  </nz-input-group>
  <ng-template #suffixIcon>
    <i nz-icon nzType="search"></i>
  </ng-template>

  <nz-tree #treeComponentObj [nzData]="this.bindObj.nodes" [nzAsyncData]="this.dataSourceObj.async"
    [nzExpandAll]="bindObj.expandAll" [nzBlockNode]="true" [nzCheckStrictly]="this.bindObj.checkStrictly"
    [nzCheckable]="this.bindObj.showCheckBox" [nzShowLine]="this.bindObj.showLine" (nzClick)="clickNode($event)"
    (nzExpandChange)="expandNode($event)" [nzTreeTemplate]="nzTreeTemplate"
    [nzSearchValue]="this.bindObj.searchValue" [nzSelectedKeys]="this.bindObj.defaultSelectedKeys">
  </nz-tree>
  <ng-template #nzTreeTemplate let-node>
    <span class="custom-node" [class.active]="ACTIVED_NODE?.key === node.key">
      <span *ngIf="!node.isLeaf">
        <i nz-icon style="padding-right: 3px;" [nzType]="node.isExpanded ? 'folder-open' : 'folder'"
          (click)="openFolder(node)"></i>
        <cn-custom-group-state *ngIf="this.bindObj.enableState" [config]="this.bindObj.leftIconState"
          [currentValue]="node" (updateValue)="iconStateValueChange($event)"></cn-custom-group-state>

        <ng-container *ngIf="node.isMatched">
          <span class="file-name"> {{searchTargetString(node.title)[0]}}</span>
          <span class="highlight"> {{searchTargetString(node.title)[1]}} </span>
          <span class="file-name">{{searchTargetString(node.title)[2]}}</span>
        </ng-container>
        <ng-container *ngIf="!node.isMatched">
          <span class="file-name">{{ node.title }}</span>
        </ng-container>
        <cn-custom-group-state *ngIf="this.bindObj.enableState" [config]="this.bindObj.rightIconState"
          [currentValue]="node" (updateValue)="iconStateValueChange($event)"></cn-custom-group-state>
        <span class="folder-desc" *ngIf="config.descField">{{ node?.origin[config.desc] }}</span>
      </span>
      <span *ngIf="node.isLeaf">
        <i nz-icon nzType="file" style="padding-right: 3px;"></i>
        <cn-custom-group-state *ngIf="this.bindObj.enableState" [config]="this.bindObj.leftIconState"
          [currentValue]="node" (updateValue)="iconStateValueChange($event)"></cn-custom-group-state>
        <ng-container *ngIf="node.isMatched">

          <span class="file-name"> {{searchTargetString(node.title)[0]}}</span>
          <span class="highlight"> {{searchTargetString(node.title)[1]}} </span>
          <span class="file-name">{{searchTargetString(node.title)[2]}}</span>

        </ng-container>
        <ng-container *ngIf="!node.isMatched">
          <span class="file-name">{{ node.title }}</span>
        </ng-container>
        <cn-custom-group-state *ngIf="this.bindObj.enableState" [config]="this.bindObj.rightIconState"
          [currentValue]="node" (updateValue)="iconStateValueChange($event)"></cn-custom-group-state>

        <span class="file-desc" *ngIf="config.descField">{{ node?.origin[config.desc] }}</span>
      </span>
    </span>
  </ng-template>

</nz-spin>